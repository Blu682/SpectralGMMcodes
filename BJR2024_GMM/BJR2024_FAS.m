function [f FAS] = BJR2024_FAS(Mw, R, H, Sc)
%
%**************************************************************************
% Matlab function for predicting FAS for the HIM region, India 
%
%  AUTHOR   : Bhargavi Podili
%  DATE     : 7th March, 2024
%  REFERENCE: Bhargavi Podili, Jahnabi Basu and Raghukanth STG (2024), 
%             Spectral Ground Motion Models for Himalayas using Transfer 
%             learning technique, Journal of Earthquake Engineering
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%
% INPUT PARAMETERS: 
% Param.....|Description.............................|Range
% Mw.........Moment magnitude.........................[4.0 7.9]
% R..........Rupture distance (for Mw>=7) in km
%  ..........Hypocentral distance (for Mw<6) in km....[10 862]
% H..........Hypocentral depth in km..................[5 80]
% Sc.........site class
%            Sc = 0 for rock ground (Vs30 > 700m/s)
%            Sc = 1 for firm ground (375 < Vs30 ≤ 700m/s) 
%            Sc = 2 for soft soil (Vs30 ≤ 375m/s)
%~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
%
% OUTPUT PARAMETERS:
% Param.......|Description                          
% f...........frequency range : 0.1 to 100 Hz
% FAS.........Fourier Amplitude Spectrum in g-s
%**************************************************************************
%
f = [0.10,0.15,0.2,0.25,0.30,0.35,0.40,0.45,0.50,0.55,0.60,0.65,0.70,...
    0.75,0.80,0.85,0.90,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,...
    19,20,25,30,35,40,45,50,60,70,80,100];
%
% Local data characteristics ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
HIMdata_fas.mean_input = [5.61082568807340,187.553575091141,...
    4.75353420514898,18.2251376146789,1.08623853211009];
HIMdata_fas.std_input = [1.01733696522318,191.279590227001,...
    1.00406640804350,11.0248287313860,0.914493982740416];
HIMdata_fas.mean_target = [-3.79141978,-3.700643977,-3.648094509,...	
   -3.533499292,-3.455269023,-3.397753537,-3.35209958,-3.310517955,...
   -3.288320423,-3.262554776,-3.240195835,-3.217094685,-3.187953114,...
   -3.165988007,-3.149010589,-3.134758919,-3.122676947,-3.094014317,...
   -2.915923602,-2.846821314,-2.853353971,-2.884138517,-2.920342524,...
   -2.988088882,-3.096655427,-3.190148522,-3.266931426,-3.331901572,...
   -3.401546328,-3.464781109,-3.524135961,-3.579424046,-3.630139122,...
   -3.678743973,-3.727690625,-3.776482223,-3.825862358,-4.037474198,...
   -4.22452963,-4.378803983,-4.565569663,-4.807736504,-5.049902615,...
   -5.534234746,-6.0185669,-6.502899057,-7.471563403];
HIMdata_fas.std_target = [0.938517431,1.009248819,1.007589346,...
    1.037114017,1.056134762,1.05863471,1.045569767,1.025837818,...
    1.004837333,0.988478043,0.968920467,0.95797475,0.953648775,...
    0.943940939,0.931215185,0.922633354,0.915010375,0.888670639,...
    0.733728793,0.665698615,0.606398876,0.568112938,0.554556853,...
    0.528324693,0.52201914,0.526625849,0.524455959,0.526365403,...
    0.520019788,0.514627495,0.51535289,0.513727667,0.509519696,...
    0.504763113,0.502944934,0.502730211,0.500644638,0.507620422,...
    0.536779969,0.562658534,0.605515459,0.610429392,0.616658986,...
    0.632897687,0.653850857,0.679082238,0.740558587];
%
% Input data ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
lnR = log(R);
Input = [Mw R lnR H Sc];
%
% Normalizing ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
NorInput = (Input-HIMdata_fas.mean_input)./HIMdata_fas.std_input;
%
% Predicted values ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
load myDNNfas.mat
pred = predict(myDNNfas,NorInput')'.*HIMdata_fas.std_target+...
       HIMdata_fas.mean_target; 
FAS = 10.^pred;
%**************************************************************************
end

